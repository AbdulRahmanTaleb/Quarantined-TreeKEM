


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>protocol Coverage Report > CryptoBasicsTestVector</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope: protocol<span class="separator">|</span>    <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.github.traderjoe95.mls.protocol.interop.crypto</a>
</div>

<h1>Coverage Summary for Class: CryptoBasicsTestVector (com.github.traderjoe95.mls.protocol.interop.crypto)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
<th class="coverageStat 
">
  Instruction, %
</th>
</tr>
<tr>
  <td class="name">CryptoBasicsTestVector</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (16/16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (84/84)
  </span>
</td>
</tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (14/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (61/61)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$Companion$load$1</td>
    <td class="coverageStat"/>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$DeriveSecret</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (8/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (30/30)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$DeriveSecret$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (33/33)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$DeriveTreeSecret</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (12/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (46/46)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$DeriveTreeSecret$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (10/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (46/46)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$EncryptWithLabel</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (18/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (78/78)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$EncryptWithLabel$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (15/15)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (69/69)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$ExpandWithLabel</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (12/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (46/46)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$ExpandWithLabel$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (10/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (58/58)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$RefHash</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (30/30)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$RefHash$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (29/29)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$SignWithLabel</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (12/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (46/46)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">CryptoBasicsTestVector$SignWithLabel$Companion</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (9/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (63/63)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (25/25)
  </span>
</td>
    <td class="coverageStat"/>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (153/153)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (719/719)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.github.traderjoe95.mls.protocol.interop.crypto
&nbsp;
&nbsp;import com.github.traderjoe95.mls.protocol.crypto.CipherSuite
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getCipherSuite
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getCiphertext
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getHashReference
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getHexBinary
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getHpkePrivateKey
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getHpkePublicKey
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getKemOutput
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getSecret
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getSignature
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getSignaturePrivateKey
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getSignaturePublicKey
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getUInt
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.getUShort
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.nextString
&nbsp;import com.github.traderjoe95.mls.protocol.interop.util.nextUShort
&nbsp;import com.github.traderjoe95.mls.protocol.tree.Ratchet.Companion.deriveTreeSecret
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.Ciphertext
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.HashReference
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.HpkeCiphertext
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.HpkeKeyPair
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.HpkePrivateKey
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.HpkePublicKey
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.KemOutput
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.Secret
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.Signature
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.SignaturePrivateKey
&nbsp;import com.github.traderjoe95.mls.protocol.types.crypto.SignaturePublicKey
&nbsp;import com.github.traderjoe95.mls.protocol.util.unsafe
&nbsp;import io.vertx.core.Vertx
&nbsp;import io.vertx.core.json.JsonObject
&nbsp;import io.vertx.kotlin.core.json.get
&nbsp;import io.vertx.kotlin.coroutines.coAwait
&nbsp;import kotlin.random.Random
&nbsp;import kotlin.random.nextInt
&nbsp;import kotlin.random.nextUInt
&nbsp;
<b class="fc">&nbsp;data class CryptoBasicsTestVector(</b>
<b class="fc">&nbsp;  val cipherSuite: CipherSuite,</b>
<b class="fc">&nbsp;  val refHash: RefHash,</b>
<b class="fc">&nbsp;  val expandWithLabel: ExpandWithLabel,</b>
<b class="fc">&nbsp;  val deriveSecret: DeriveSecret,</b>
<b class="fc">&nbsp;  val deriveTreeSecret: DeriveTreeSecret,</b>
<b class="fc">&nbsp;  val signWithLabel: SignWithLabel,</b>
<b class="fc">&nbsp;  val encryptWithLabel: EncryptWithLabel,</b>
&nbsp;) {
<b class="fc">&nbsp;  constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;    json.getCipherSuite(&quot;cipher_suite&quot;),</b>
<b class="fc">&nbsp;    RefHash(json[&quot;ref_hash&quot;]),</b>
<b class="fc">&nbsp;    ExpandWithLabel(json[&quot;expand_with_label&quot;]),</b>
<b class="fc">&nbsp;    DeriveSecret(json[&quot;derive_secret&quot;]),</b>
<b class="fc">&nbsp;    DeriveTreeSecret(json[&quot;derive_tree_secret&quot;]),</b>
<b class="fc">&nbsp;    SignWithLabel(json[&quot;sign_with_label&quot;]),</b>
<b class="fc">&nbsp;    EncryptWithLabel(json[&quot;encrypt_with_label&quot;]),</b>
&nbsp;  )
&nbsp;
&nbsp;  companion object {
&nbsp;    suspend fun load(
&nbsp;      vertx: Vertx,
<b class="fc">&nbsp;      file: String = &quot;testvectors/crypto-basics.json&quot;,</b>
&nbsp;    ): List&lt;CryptoBasicsTestVector&gt; =
<b class="fc">&nbsp;      vertx.fileSystem()</b>
<b class="fc">&nbsp;        .readFile(file)</b>
<b class="fc">&nbsp;        .coAwait()</b>
<b class="fc">&nbsp;        .toJsonArray()</b>
<b class="fc">&nbsp;        .map { CryptoBasicsTestVector(it as JsonObject) }</b>
&nbsp;
&nbsp;    fun generate(cipherSuite: CipherSuite): CryptoBasicsTestVector =
<b class="fc">&nbsp;      CryptoBasicsTestVector(</b>
<b class="fc">&nbsp;        cipherSuite,</b>
<b class="fc">&nbsp;        RefHash.generate(cipherSuite),</b>
<b class="fc">&nbsp;        ExpandWithLabel.generate(cipherSuite),</b>
<b class="fc">&nbsp;        DeriveSecret.generate(cipherSuite),</b>
<b class="fc">&nbsp;        DeriveTreeSecret.generate(cipherSuite),</b>
<b class="fc">&nbsp;        SignWithLabel.generate(cipherSuite),</b>
<b class="fc">&nbsp;        EncryptWithLabel.generate(cipherSuite),</b>
&nbsp;      )
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class RefHash(val label: String, val value: ByteArray, val out: HashReference) {</b>
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getHexBinary(&quot;value&quot;),</b>
<b class="fc">&nbsp;      json.getHashReference(&quot;out&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): RefHash {
<b class="fc">&nbsp;        val label = Random.nextString()</b>
<b class="fc">&nbsp;        val value = Random.nextBytes(Random.nextInt(0..1024))</b>
&nbsp;
<b class="fc">&nbsp;        return RefHash(</b>
<b class="fc">&nbsp;          label,</b>
<b class="fc">&nbsp;          value,</b>
<b class="fc">&nbsp;          cipherSuite.refHash(label, value),</b>
&nbsp;        )
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class ExpandWithLabel(</b>
<b class="fc">&nbsp;    val secret: Secret,</b>
<b class="fc">&nbsp;    val label: String,</b>
<b class="fc">&nbsp;    val context: ByteArray,</b>
<b class="fc">&nbsp;    val length: UShort,</b>
<b class="fc">&nbsp;    val out: Secret,</b>
&nbsp;  ) {
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json.getSecret(&quot;secret&quot;),</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getHexBinary(&quot;context&quot;),</b>
<b class="fc">&nbsp;      json.getUShort(&quot;length&quot;),</b>
<b class="fc">&nbsp;      json.getSecret(&quot;out&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): ExpandWithLabel =
<b class="fc">&nbsp;        cipherSuite.generateSecret(Random.nextUShort(16U..128U)).let { secret -&gt;</b>
<b class="fc">&nbsp;          val label = Random.nextString()</b>
<b class="fc">&nbsp;          val context = Random.nextBytes(Random.nextInt(0..128))</b>
<b class="fc">&nbsp;          val length = Random.nextUShort(16U..128U)</b>
&nbsp;
<b class="fc">&nbsp;          ExpandWithLabel(</b>
<b class="fc">&nbsp;            secret,</b>
<b class="fc">&nbsp;            label,</b>
<b class="fc">&nbsp;            context,</b>
<b class="fc">&nbsp;            length,</b>
<b class="fc">&nbsp;            cipherSuite.expandWithLabel(secret, label, context, length),</b>
&nbsp;          )
&nbsp;        }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class DeriveSecret(</b>
<b class="fc">&nbsp;    val secret: Secret,</b>
<b class="fc">&nbsp;    val label: String,</b>
<b class="fc">&nbsp;    val out: Secret,</b>
&nbsp;  ) {
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json.getSecret(&quot;secret&quot;),</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getSecret(&quot;out&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): DeriveSecret =
<b class="fc">&nbsp;        cipherSuite.generateSecret(Random.nextUShort(16U..128U)).let { secret -&gt;</b>
<b class="fc">&nbsp;          val label = Random.nextString()</b>
&nbsp;
<b class="fc">&nbsp;          DeriveSecret(</b>
<b class="fc">&nbsp;            secret,</b>
<b class="fc">&nbsp;            label,</b>
<b class="fc">&nbsp;            cipherSuite.deriveSecret(secret, label),</b>
&nbsp;          )
&nbsp;        }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class DeriveTreeSecret(</b>
<b class="fc">&nbsp;    val secret: Secret,</b>
<b class="fc">&nbsp;    val label: String,</b>
<b class="fc">&nbsp;    val generation: UInt,</b>
<b class="fc">&nbsp;    val length: UShort,</b>
<b class="fc">&nbsp;    val out: Secret,</b>
&nbsp;  ) {
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json.getSecret(&quot;secret&quot;),</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getUInt(&quot;generation&quot;),</b>
<b class="fc">&nbsp;      json.getUShort(&quot;length&quot;),</b>
<b class="fc">&nbsp;      json.getSecret(&quot;out&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): DeriveTreeSecret =
<b class="fc">&nbsp;        cipherSuite.generateSecret(cipherSuite.hashLen).let { secret -&gt;</b>
<b class="fc">&nbsp;          val label = Random.nextString()</b>
<b class="fc">&nbsp;          val generation = Random.nextUInt()</b>
<b class="fc">&nbsp;          val length = Random.nextUShort(16U..128U)</b>
&nbsp;
<b class="fc">&nbsp;          DeriveTreeSecret(</b>
<b class="fc">&nbsp;            secret,</b>
<b class="fc">&nbsp;            label,</b>
<b class="fc">&nbsp;            generation,</b>
<b class="fc">&nbsp;            length,</b>
<b class="fc">&nbsp;            cipherSuite.deriveTreeSecret(secret, label, generation, length),</b>
&nbsp;          )
&nbsp;        }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class SignWithLabel(</b>
<b class="fc">&nbsp;    val priv: SignaturePrivateKey,</b>
<b class="fc">&nbsp;    val pub: SignaturePublicKey,</b>
<b class="fc">&nbsp;    val content: ByteArray,</b>
<b class="fc">&nbsp;    val label: String,</b>
<b class="fc">&nbsp;    val signature: Signature,</b>
&nbsp;  ) {
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json.getSignaturePrivateKey(&quot;priv&quot;),</b>
<b class="fc">&nbsp;      json.getSignaturePublicKey(&quot;pub&quot;),</b>
<b class="fc">&nbsp;      json.getHexBinary(&quot;content&quot;),</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getSignature(&quot;signature&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): SignWithLabel =
<b class="fc">&nbsp;        cipherSuite.generateSignatureKeyPair().let { (private, public) -&gt;</b>
<b class="fc">&nbsp;          val content = Random.nextBytes(Random.nextInt(0..1024))</b>
<b class="fc">&nbsp;          val label = Random.nextString()</b>
&nbsp;
<b class="fc">&nbsp;          SignWithLabel(</b>
<b class="fc">&nbsp;            private,</b>
<b class="fc">&nbsp;            public,</b>
<b class="fc">&nbsp;            content,</b>
<b class="fc">&nbsp;            label,</b>
<b class="fc">&nbsp;            unsafe { cipherSuite.signWithLabel(private, label, content).bind() },</b>
&nbsp;          )
&nbsp;        }
&nbsp;    }
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  data class EncryptWithLabel(</b>
<b class="fc">&nbsp;    val priv: HpkePrivateKey,</b>
<b class="fc">&nbsp;    val pub: HpkePublicKey,</b>
<b class="fc">&nbsp;    val label: String,</b>
<b class="fc">&nbsp;    val context: ByteArray,</b>
<b class="fc">&nbsp;    val plaintext: ByteArray,</b>
<b class="fc">&nbsp;    val kemOutput: KemOutput,</b>
<b class="fc">&nbsp;    val ciphertext: Ciphertext,</b>
&nbsp;  ) {
&nbsp;    val keyPair: HpkeKeyPair
<b class="fc">&nbsp;      get() = HpkeKeyPair(priv, pub)</b>
&nbsp;
&nbsp;    val hpkeCiphertext: HpkeCiphertext
<b class="fc">&nbsp;      get() = HpkeCiphertext(kemOutput, ciphertext)</b>
&nbsp;
<b class="fc">&nbsp;    constructor(json: JsonObject) : this(</b>
<b class="fc">&nbsp;      json.getHpkePrivateKey(&quot;priv&quot;),</b>
<b class="fc">&nbsp;      json.getHpkePublicKey(&quot;pub&quot;),</b>
<b class="fc">&nbsp;      json[&quot;label&quot;],</b>
<b class="fc">&nbsp;      json.getHexBinary(&quot;context&quot;),</b>
<b class="fc">&nbsp;      json.getHexBinary(&quot;plaintext&quot;),</b>
<b class="fc">&nbsp;      json.getKemOutput(&quot;kem_output&quot;),</b>
<b class="fc">&nbsp;      json.getCiphertext(&quot;ciphertext&quot;),</b>
&nbsp;    )
&nbsp;
&nbsp;    companion object {
&nbsp;      fun generate(cipherSuite: CipherSuite): EncryptWithLabel =
<b class="fc">&nbsp;        cipherSuite.generateHpkeKeyPair().let { (private, public) -&gt;</b>
<b class="fc">&nbsp;          val label = Random.nextString()</b>
<b class="fc">&nbsp;          val context = Random.nextBytes(Random.nextInt(0..128))</b>
<b class="fc">&nbsp;          val plaintext = Random.nextBytes(Random.nextInt(0..1024))</b>
&nbsp;
<b class="fc">&nbsp;          val (kemOutput, ciphertext) =</b>
<b class="fc">&nbsp;            unsafe {</b>
<b class="fc">&nbsp;              cipherSuite.encryptWithLabel(public, label, context, plaintext).bind()</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;          EncryptWithLabel(</b>
<b class="fc">&nbsp;            private,</b>
<b class="fc">&nbsp;            public,</b>
<b class="fc">&nbsp;            label,</b>
<b class="fc">&nbsp;            context,</b>
<b class="fc">&nbsp;            plaintext,</b>
<b class="fc">&nbsp;            kemOutput,</b>
<b class="fc">&nbsp;            ciphertext,</b>
&nbsp;          )
&nbsp;        }
&nbsp;    }
&nbsp;  }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-03-25 13:33</div>
</div>
</body>
</html>
